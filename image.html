<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HF Image Generator Test</title>
    <style>
        body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; margin: 20px; }
        .container { width: 80%; max-width: 600px; }
        input, button { padding: 10px; margin-top: 10px; width: 100%; box-sizing: border-box; }
        #status { margin-top: 10px; font-weight: bold; }
        #imageContainer img { max-width: 100%; margin-top: 20px; border: 1px solid #ccc; }
        .loading::after { content: ' Generating...'; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { content: '|'; } 33% { content: '/'; } 66% { content: '-'; } 100% { content: '\\'; } }
    </style>
</head>
<body>
    <div class="container">
        <h2>Hugging Face AI Image Generator</h2>
        <p>This uses the free Hugging Face Serverless Inference API. You must provide a valid Access Token.</p>
        
        <label for="accessToken">Hugging Face Access Token:</label>
        <input type="password" id="accessToken" placeholder="Enter your hf_**** token">
        
        <label for="prompt">Image Prompt:</label>
        <input type="text" id="prompt" value="Astronaut riding a horse in a PS2 style game">
        
        <button onclick="generateImage()">Generate Image</button>
        
        <p id="status">Enter your token and prompt</p>
        <div id="imageContainer"></div>
    </div>

    <script>
        async function generateImage() {
            const token = document.getElementById('accessToken').value;
            const prompt = document.getElementById('prompt').value;
            const status = document.getElementById('status');
            const imageContainer = document.getElementById('imageContainer');
            
            if (!token || !prompt) {
                status.textContent = 'Please provide both a token and a prompt.';
                return;
            }

            status.textContent = 'Generating image... (This might take a moment)';
            imageContainer.innerHTML = ''; // Clear previous image

            try {
                // The Inference API is accessed via a direct fetch call
                const response = await fetch(
                    "https://api-inference.huggingface.co/models/glif-loradex-trainer/djmenorobl_PS2_STYLE_IMAGE_GENERATOR",
                    {
                        headers: { Authorization: `Bearer ${token}` },
                        method: "POST",
                        body: JSON.stringify({ inputs: prompt, parameters: { num_inference_steps: 5 } }),
                    }
                );

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error || 'Failed to generate image');
                }

                // The response is a Blob containing the image data
                const blob = await response.blob();
                const objectUrl = URL.createObjectURL(blob);

                const imgElement = document.createElement('img');
                imgElement.src = objectUrl;
                imgElement.alt = prompt;
                imageContainer.appendChild(imgElement);
                status.textContent = 'Image generated successfully!';

            } catch (error) {
                status.textContent = `Error: ${error.message}`;
                console.error(error);
            }
        }
    </script>
</body>
</html>
